<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>VslicR5 - OGG Converter</title>
<style>
  /* MATCHING YOUR INDEX CSS */
  * {
    -webkit-tap-highlight-color: transparent;
    box-sizing: border-box;
  }

  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #eee;
    margin: 0;
    padding: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .logo-container {
    width: 100%;
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
  }

  .logo-container img {
    width: 120px;
    height: 120px;
    image-rendering: pixelated;
    object-fit: contain;
  }

  .main-content {
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 600px;
    gap: 12px;
    background: #1e1e1e;
    padding: 20px;
    border: 1px solid #444;
    border-radius: 8px;
  }

  .status-box {
    width: 100%;
    height: 100px;
    background: #000;
    color: #0f0;
    border: 1px solid #444;
    padding: 8px;
    font-family: monospace;
    font-size: 12px;
    overflow-y: auto;
    margin-bottom: 10px;
  }

  .row {
    display: flex;
    gap: 10px;
    align-items: center;
    justify-content: center;
  }

  button, .upload-btn {
    padding: 10px 20px;
    background: #222;
    color: #fff;
    border: 1px solid #555;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    text-transform: uppercase;
    font-size: 12px;
  }

  button:active, .upload-btn:active { background: #444; }
  button:disabled { color: #666; cursor: not-allowed; }

  #downloadLink {
    display: none;
    color: #00f2ff;
    text-decoration: none;
    border: 1px solid #00f2ff;
    padding: 10px;
    text-align: center;
    border-radius: 6px;
    margin-top: 10px;
  }
</style>
</head>

<body>

<div class="logo-container">
  <img src="logo.png" alt="VslicR5 Logo">
</div>

<div class="main-content">
  <h2 style="margin-top:0; text-align:center; color:#0f0;">OGG CONVERTER</h2>
  
  <div class="status-box" id="log">Ready to load...</div>

  <div class="row">
    <label class="upload-btn">
      SELECT FILE (MP4/MP3/WAV)
      <input type="file" id="fileInput" hidden />
    </label>
    <button id="convertBtn" disabled>CONVERT TO .OGG</button>
  </div>

  <a id="downloadLink">DOWNLOAD CONVERTED OGG</a>
</div>

<!-- Load FFmpeg.wasm from CDN -->
<script src="unpkg.com"></script>

<script>
  const { createFFmpeg, fetchFile } = FFmpeg;
  const ffmpeg = createFFmpeg({ log: true });
  
  const logEl = document.getElementById('log');
  const convertBtn = document.getElementById('convertBtn');
  const fileInput = document.getElementById('fileInput');
  const downloadLink = document.getElementById('downloadLink');

  function updateLog(msg) {
    logEl.innerText += `\n> ${msg}`;
    logEl.scrollTop = logEl.scrollHeight;
  }

  // Initialize FFmpeg
  (async () => {
    updateLog("Loading FFmpeg engine...");
    await ffmpeg.load();
    updateLog("Engine Ready.");
    convertBtn.disabled = false;
  })();

  convertBtn.addEventListener('click', async () => {
    if (!fileInput.files[0]) return alert("Please select a file first!");
    
    const file = fileInput.files[0];
    const name = file.name.split('.').slice(0, -1).join('.');
    
    convertBtn.disabled = true;
    updateLog(`Starting conversion: ${file.name}`);

    // Write file to virtual memory
    ffmpeg.FS('writeFile', 'input', await fetchFile(file));

    // Run conversion (strips video if present, converts to ogg)
    // -vn removes video, -c:a libvorbis is the standard ogg codec
    await ffmpeg.run('-i', 'input', '-vn', '-c:a', 'libvorbis', 'output.ogg');

    // Read result
    const data = ffmpeg.FS('readFile', 'output.ogg');

    // Create Download Link
    const url = URL.createObjectURL(new Blob([data.buffer], { type: 'audio/ogg' }));
    downloadLink.href = url;
    downloadLink.download = `${name}.ogg`;
    downloadLink.style.display = 'block';
    downloadLink.innerText = `DOWNLOAD ${name.toUpperCase()}.OGG`;

    updateLog("Conversion Finished!");
    convertBtn.disabled = false;
  });
</script>

</body>
</html>
